AWSTemplateFormatVersion: '2010-09-09'
Metadata: {}
Parameters: {}
Mappings: {}
Conditions: {}
Resources:
  EnnubeStarterDeploymentStorage:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: ennube-starter-deployment-storage
      AccessControl: Private
  GatewayWww:
    Type: 'AWS::ApiGateway::RestApi'
    Properties:
      Name: '@ennube/starter-www'
  GatewayWwwURLGET:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      RestApiId:
        Ref: GatewayWww
      ResourceId:
        'Fn::GetAtt':
          - GatewayWww
          - RootResourceId
      HttpMethod: GET
      AuthorizationType: NONE
      RequestParameters: {}
      Integration:
        Type: MOCK
        IntegrationHttpMethod: GET
      MethodResponses:
        - StatusCode: '200'
          ResponseModels:
            text/html: Empty
          ResponseParameters:
            method.response.header.SetCookie: false
  GatewayWwwURLRobotsTxt:
    Type: 'AWS::ApiGateway::Resource'
    Properties:
      RestApiId:
        Ref: GatewayWww
      ParentId:
        'Fn::GetAtt':
          - GatewayWww
          - RootResourceId
      PathPart: robots.txt
  GatewayWwwURLRobotsTxtGET:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      RestApiId:
        Ref: GatewayWww
      ResourceId:
        Ref: GatewayWwwURLRobotsTxt
      HttpMethod: GET
      AuthorizationType: NONE
      RequestParameters: {}
      Integration:
        Type: MOCK
        IntegrationHttpMethod: GET
      MethodResponses:
        - StatusCode: '200'
          ResponseModels:
            text/html: Empty
          ResponseParameters:
            method.response.header.SetCookie: false
  ServiceRole:
    Type: 'AWS::IAM::Role'
    Properties:
      Path: /
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - 'sts:AssumeRole'
  ServicePolicy:
    Type: 'AWS::IAM::Policy'
    Properties:
      PolicyName: EnnubeStarter-DevelopmentServicePolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - 'logs:CreateLogGroup'
              - 'logs:CreateLogStream'
              - 'logs:PutLogEvents'
            Resource: 'arn:aws:logs:us-east-1:*:*'
      Roles:
        - Ref: ServiceRole
  IndexHTTPServicedevelopmentLambda:
    Type: 'AWS::Lambda::Function'
    Properties:
      FunctionName: IndexHTTPServicedevelopmentLambda
      Runtime: nodejs4.3
      MemorySize: 256
      Timeout: 6
      Handler: IndexHTTPService.handler
      Role:
        'Fn::GetAtt':
          - ServiceRole
          - Arn
      Code:
        S3Bucket:
          Ref: EnnubeStarterDeploymentStorage
        S3Key: IndexHTTPService.zip
Outputs: {}
